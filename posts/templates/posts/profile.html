{% extends "posts/base-inner.html" %}
{% load static %}
{% block title %}{{ user.name }}({{ user.user_name }}) • Instagram 사진 및 동영상{% endblock %}

{% block page_content %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">

<script type="text/javascript">

    // nav scroll resize
    window.onscroll = function() {scrollFunction()};

    $(document).ready(function(){

        $('.gallery-item').on('click', function() {
            let postId = $(this).data('postId');
            $.ajax({
                url: "/posts/"+postId,
                method: "GET",
                dataType: "json",
                success : function(res){
                    let post = res;

                    // post
                    $('#profile-image').attr('src', post.image);
                    $('#userName').html(post.user.user_name);
                    $('#userNameReply').html(post.user.user_name);
                    $('.content-reply').first().html(post.content);
                    $('#feed-more-modal-update').attr('href', "{% url 'post-update' pk="000" %}".replace(/000/, postId));
                    $('#feed-more-modal-delete').attr('href', "{% url 'post-delete' pk="000" %}".replace(/000/, postId));
                    $('.feed-box-write-time').first().html(post.create_dt_timesince + ' 전');

                },
                error : function(xhr, status, error){
                    console.log(status);                // 'error'
                    console.log(error);                 // 'Not Found'
                }
            });

            $('#gallery-item-modal').css('display','block');
            document.body.style.overflow = 'hidden';
        });

        $('#gallery-item-modal').on('click', function (e){
            if(e.target.className == "modal"){
                $('#gallery-item-modal').css('display','none');
                $('.profile-image').attr('src', '');
                $('#userName').html('');
                $('#userNameReply').html('');
                $('.content-reply').html('');
                document.body.style.overflow = '';
            }
        });

        $('#feed-more-modal').on('click', function (e){
            console.log('feed-more-modal');
            if(e.target.className == "modal"){
                $('#feed-more-modal').css('display','none');
                $('#feed-more-modal-delete').attr('href', '');
                $('#feed-more-modal-update').attr('href', '');
                document.body.style.overflow = '';
            }
        });

        $('.feed-more-icon').on('click', function (e) {
            console.log('feed-more-icon');
            $('#feed-more-modal').css('display','block');
            document.body.style.overflow = 'hidden';
        });

        $('#feed-more-modal-cancel').on('click', function() {
            $('#feed-more-modal').css('display','none');
            document.body.style.overflow = '';
        });
    });

    function scrollFunction() {
      if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
          $('.nav').css('padding', '10px 0');
          $('.scrolldown-hide').fadeOut(200);
      } else {
          $('.nav').css('padding', '20px 0');
          $('.scrolldown-hide').fadeIn(200);
      }
    }
</script>

<div class="main">
</div>

  <header>
	<div class="container">

        <div class="profile">
			<div class="profile-image">
				<img class="userImgLarge no-drag float-l" src="{%if user.profile_image != '' %} {{user.profile_image.url}} {% endif %}">
			</div>
			<div class="profile-user-settings">
				<h1 class="profile-user-name vertical-m">{{user.user_name}}</h1>
                <div class="profile-edit-div">
                    <a href="{% url 'profile_update' pk=user.id %}" class="a-none">
                        <button class="btn profile-edit-btn vertical-m">프로필 편집</button>
                    </a>
                    <img src="{% static 'images/settings.png' %}" class="icon-medium vertical-m" alt="logo"/>
                </div>

			</div>

			<div class="profile-stats">
				<ul>
					<li>게시물 <span class="profile-stat-count">{{object_list.count}}</span></li>
{#					<li>팔로워 <span class="profile-stat-count">188</span></li>#}
{#					<li>팔로우 <span class="profile-stat-count">206</span></li>#}
				</ul>
			</div>

			<div class="profile-bio">
				<p>
					<span class="profile-real-name">{{user.name}}</span><br>
					<span>{{user.comment}}</span>
					<br>
					<span><a href="http://{{user.web_site}}" class="underline-none " target="_blank">{{user.web_site}}</a></span>
        		</p>
			</div>

		</div>
		<!-- End of profile section -->

	</div>
	<!-- End of container -->

</header>

<main>


	<div class="container">
		<div class="gallery">
          {% for post in object_list %}
            <div class="gallery-item" tabindex="0" data-post-id="{{ post.id }}">
              <img src="{{post.image.url}}" class="gallery-image" alt="">
              <div class="gallery-item-info">
                <ul>
    {#              <li class="gallery-item-likes"><span class="visually-hidden">Likes:</span><i class="fas fa-heart" aria-hidden="true"></i> 56</li>#}
    {#              <li class="gallery-item-comments"><span class="visually-hidden">Comments:</span><i class="fas fa-comment" aria-hidden="true"></i> 2</li>#}
                </ul>
              </div>
            </div>
          {% endfor %}
        </div>
    </div>

    <div id="gallery-item-modal" class="modal">
        <div class="profile-modal-content">
            <div class="modal-profile-container">
                <div class="profile-image-area">
                    <img id="profile-image" class="profile-image" src="">
                </div>
                <div class="profile-content-area">
                    <div class="feed-box-top border-bottom">
                        {% if user.profile_image %}
                            <img class="userImg no-drag float-l" src="{{user.profile_image.url}}" alt="user" />
                        {% endif %}
                        <span id="userName" class="userName"></span>
                        <span class="hamburger">
                            <a class="feed-more-icon"
                               data-post-id=""
                               data-update-url=""
                               data-delete-url=""
                            >
                                <img class="feed-more no-drag" src="{% static 'images/more.png' %}" alt="more" />
                            </a>
                        </span>
                    </div>
                    <div class="feed-box-content">
                        <div class="feed-box-content-reply">
                            <div class="feed-box-content-reply-right">
                                <img class="userImg no-drag float-l" src="{{user.profile_image.url}}" alt="user" />
                            </div>
                            <div class="feed-box-content-reply-left">
                                <span id="userNameReply" class="userName"></span>
                                <span class="content-reply "></span>
                                <p class="feed-box-write-content"></p>
                                <p class="feed-box-write-time"></p>
                            </div>

                        </div>
                        <!-- TODO: for loop reply
                        <div class="feed-box-content-reply">
                        </div>
                        -->
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="feed-more-modal" class="modal">
        <div class="modal-content">
            <a href="" id="feed-more-modal-delete" class="modal-button delete-color a-none">삭제</a>
            <a href="" id="feed-more-modal-update" class="modal-button modal-button-border-top a-none">수정</a>
            <a href="javascript:void(0);" id="feed-more-modal-cancel" class="modal-button modal-button-border-top a-none">취소</a>
        </div>
    </div>

		<!-- End of gallery -->
{#		<div class="loader"></div>#}


	</div>
	<!-- End of container -->

</main>

{% endblock %}